# Using the Mobile Adapter Generator with Go

This document provides a comprehensive guide for generating native mobile data models from a Go codebase.

## 1. Core Concept: Source File Analysis

The generator works with Go by parsing `.go` source files directly. It does not require a compiled binary. It searches for `struct` definitions and analyzes their fields and types to create the mobile models.

## 2. How to Mark Structs for Discovery

Discovery in Go is driven by a special comment placed directly above a `struct` definition. This approach avoids adding non-standard dependencies to your Go project.

#### Step 1: Add the Tracking Comment
Place a comment in the format `// @YourTrackAttribute` on the line immediately preceding the `type` definition of your struct. The `TrackAttribute` is a simple marker that you define.

```go
package models

import (
    "time"
    "github.com/google/uuid"
)

// @ExportToMobile
type PhotoMetadata struct {
    ID          uuid.UUID         `json:"id"`
    Title       string            `json:"title"`
    Description string            `json:"description,omitempty"`
    CaptureDate time.Time         `json:"captureDate"`
    IsPublic    bool              `json:"isPublic"`
    Views       int64             `json:"views"`
    Rating      float64           `json:"rating"`
    Tags        []string          `json:"tags"`
    Camera      *CameraSettings   `json:"camera"` // Pointer for optional nested struct
}

// @ExportToMobile
type CameraSettings struct {
    Make        string  `json:"make"`
    Model       string  `json:"model"`
    FocalLength int     `json:"focalLength"`
    ISO         int     `json:"iso"`
}
Note: The generator primarily analyzes the Go type information. The json struct tags are used by Go's native JSON marshaler and are a good practice to include, but they do not drive the discovery process.
3. Configuration
You must configure the generator using environment variables in your CI/CD pipeline.
Crucial Go Variables:
LANGUAGE_GO: Must be set to true.
TRACK_ATTRIBUTE: The marker used in your tracking comments (e.g., ExportToMobile).
SOURCE_PATHS: A semicolon-separated list of paths inside the container where your .go source files are located.
Example Configuration for Android (Kotlin) Generation
code
Bash
# 1. Language and Platform
LANGUAGE_GO=true
PLATFORM_ANDROID=true

# 2. Discovery Method
# Find all structs with the "// @ExportToMobile" comment
TRACK_ATTRIBUTE=ExportToMobile

# 3. Source Path (CRITICAL)
# Path to the directory containing your Go models
SOURCE_PATHS=/src/pkg/models

# 4. Core Config
REPO_URL="https://github.com/my-org/my-repo"
BRANCH="main"
LICENSE_SERVER="https://license.my-company.com"

# 5. Output Config
OUTPUT_DIR=/src/generated-mobile-models
ANDROID_OUTPUT_DIR=./android
ANDROID_PACKAGE_NAME="com.mycompany.app.models"
Example Configuration for iOS (Swift) Generation
Note the change in PLATFORM_* and output variables.
code
Bash
# 1. Language and Platform
LANGUAGE_GO=true
PLATFORM_IOS=true

# 2. Discovery Method
TRACK_ATTRIBUTE=ExportToMobile

# 3. Source Path (CRITICAL)
SOURCE_PATHS=/src/pkg/models

# 4. Core Config
REPO_URL="https://github.com/my-org/my-repo"
BRANCH="main"
LICENSE_SERVER="https://license.my-company.com"

# 5. Output Config
OUTPUT_DIR=/src/generated-mobile-models
IOS_OUTPUT_DIR=./ios
IOS_MODULE_NAME="SharedModels"
4. Expected Output
Based on the Go examples above, the generator will produce the following files.
Generated Kotlin (PhotoMetadata.kt)
code
Kotlin
package com.mycompany.app.models

import java.time.LocalDateTime
import java.util.UUID

data class PhotoMetadata(
    val id: UUID,
    val title: String,
    val description: String?,
    val captureDate: LocalDateTime,
    val isPublic: Boolean,
    val views: Long,
    val rating: Double,
    val tags: List<String>,
    val camera: CameraSettings?
)
Generated Swift (CameraSettings.swift)
code
Swift
// Generated by 3SC Mobile Adapter Generator
import Foundation

struct CameraSettings: Codable {
    let make: String
    let model: String
    let focalLength: Int32
    let iso: Int32
}
5. Type Mapping Reference
The following table shows how common Go types are mapped to their Kotlin and Swift equivalents.
Go Type	Kotlin Type	Swift Type
string	String	String
int, int32	Int	Int32
int64	Long	Int64
bool	Boolean	Bool
float64	Double	Double
float32	Float	Float
time.Time	LocalDateTime	Date
uuid.UUID	UUID	UUID
[]byte	ByteArray	Data
[]string	List<String>	[String]
*MyStruct	MyStruct?	MyStruct?
6. Troubleshooting
Error: No classes found.
Is the comment format correct? Ensure the tracking comment is exactly // @YourTrackAttribute on its own line directly above the type ... struct line.
Is SOURCE_PATHS correct? The path must point to the directory containing your .go files inside the container's /src volume mount.
Does the attribute name match? The string in TRACK_ATTRIBUTE must exactly match the text used in your comment marker.